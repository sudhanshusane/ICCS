\setlength{\belowdisplayskip}{3pt} \setlength{\belowdisplayshortskip}{3pt}
\setlength{\abovedisplayskip}{3pt} \setlength{\abovedisplayshortskip}{3pt}

\subsection{Frames of Reference}
%
In fluid dynamics, there are two frames of reference to observe fluid motion: Eulerian and Lagrangian.
%
With the Eulerian frame of reference, the observer is in a fixed position.
%
With the Lagrangian frame of reference, the observer is attached to a fluid parcel and is moving through space and time.

%
Storage of a flow field in an Eulerian representation is typically done by means of its velocity field.
%
A velocity field $v$ is a time-dependent vector field that maps each point $x\in \mathbb R^d$ in space to the velocity of the flow field for a given time $t\in \mathbb R$
%
\begin{eqnarray}
{v} : \mathbb R^d \times \mathbb R \to \mathbb R^d,\; x,t \mapsto v(x,t)
\end{eqnarray}

%In a practical setting, the vector field is defined over a fixed, discrete mesh and represents the state of the flow field at a specific instant of time or time slice, i.e., at a specific simulation time and cycle.
%
In a practical setting, a flow field at a specific time/cycle is defined as vector data on a fixed, discrete mesh.
%
Time-varying flow is represented as a collection of such data over a variety times/cycles.


Storage of a flow field in a Lagrangian representation is done by means of its flow map $F_{t_0}^{t}$.
%
The flow map is comprised of the starting positions of massless particles $x_0$ at time $t_0$ and their respective trajectories that are interpolated using the time-dependent vector field.
%
Mathematically, a flow map is defined as the mapping
\begin{eqnarray}
F_{t_0}^{t}(x_0):\mathbb R \times \mathbb R \times \mathbb R^d \to \mathbb R^d,\; t \times t_0 \times x_0 \mapsto F_{t_0}^{t}(x_0) = x(t)
\end{eqnarray}
%
of initial values $x_0$ to the solutions of the ordinary differential equation
%
\begin{eqnarray}
\frac{d}{dt}x(t) = v(x(t),t)
\end{eqnarray}

In a practical setting, the flow map is represented as sets of particle trajectories calculated in the time interval $[t_0,t]\subset \mathbb R$.
%
The stored information, encoded in the form of known particle trajectories (i.e., a Lagrangian representation), encodes the behavior of the time-dependent vector field over an interval of time.
%
%
%Although the frames of reference are theoretically equivalent~\cite{bujack2015lagrangian}, their application in practical settings varies. 
%
%Our interest with this study is the practical setting, specifically for the \textbf{EUS} problem.
%

\subsection{Lagrangian Analysis}
Within the vector field analysis and visualization community, Lagrangian methods have been increasingly researched in the past decade. 
%
In this paper, we focus on the use of Lagrangian methods to store time-varying vector fields in situ and enable subsequent post hoc analysis.
%The interest in Lagrangian representations is driven by their potential to offer reduced memory footprint and consequently enable post hoc analysis.
%
%fueled by temporal sparsity of data, i.e., simulations store data less frequently to avoid high storage costs.
%
In sparse temporal settings, Lagrangian representations are expected to perform better than their Eulerian counterparts, and the key intuition behind this is Lagrangian representations capture the behavior of the flow field over an interval of time, as opposed to the state at a single time slice.
%
However, in addition to the frequency of temporal sampling, the nature of the vector field and spatial sampling resolution impacts the quality of reconstruction.
%

Agranovsky et al.~\cite{agranovsky2014improved} conducted the seminal work to evaluate the efficacy of reduced Lagrangian representations.
%
To maintain domain coverage, the study proposed the use of uniform spatial sampling to extract sets of temporally non-overlapping basis trajectories.
%
Next, Sane et al.~\cite{sane2018revisiting} studied the use of a fixed storage budget and a wide range of spatiotemporal configurations.
%
However, a shortcoming of both studies is the measure of efficacy using a single quantitative average error for a limited set of applications.
%
Further, all experiments were conducted in a theoretical in situ setting, i.e., files were loaded from disk. rather than integration with a simulation. 
%
Such a theoretical set up fails to capture the cost of invoking in situ processing every cycle in a tightly-coupled system.
%
More recently, Jakob et al.~\cite{Jakob20} provide in situ encumbrance costs for a tightly-coupled integration with an open source CFD solver on HPC resources.
%
However, the largest grid size per rank in this study was $4\times4$.
%
Thus, in addition to limited evaluations of efficacy, current literature lacks a measure of in situ encumbrance in representative settings.
%
%Our study explores this space by investigating the benefits and limitations of using reduced Lagrangian representations for previously unexplored time-varying vector fields.

%Recently, Pascal et al.~\cite{envirvis.20171099,siegfried2019tropical} use embedded routines to compute reduced Lagrangian data in order to explore coastal upwelling activity and visualize a derived scalar field representing trajectory density.
%
%As such, prior works considering reduced Lagrangian representations have been restricted to analytical, ocean or climate data.
%

Lagrangian representations of a time-varying vector field can be extracted by adopting various strategies.
%
Sane et al.~\cite{sane2019interpolation} explored computing trajectories of variable duration and placement. 
%and consequently proposed a post hoc interpolation scheme to reduce reconstruction error by evaluating neighborhoods across interpolations.
%
Rapp et al.~\cite{rapp2019void} applied their void-and-cluster sampling technique to identify a representative set of scattered samples.
%
Although these strategies improved accuracy, they increased computation costs and are presently limited to single node settings.
%
To address scalability challenges of extracting a Lagrangian representation in distributed memory, Sane et al.~\cite{sane2020scalable} explored an accuracy-performance tradeoff and demonstrated the use of a communication-free model that stored only trajectories that remain within the rank domain during the interval of computation.
%

Several prior works have presented strategies for post hoc reconstruction.
%
Hlawatsch et al.~\cite{hlawatsch2011hierarchical} proposed a hierarchical reconstruction scheme that can improve accuracy, but relies on access to data across multiple time intervals.
%
Chandler et al.~\cite{chandler2015interpolation} proposed a modified k-d tree as a search structure for Lagrangian data extracted from an SPH simulation.
%
Further, Chandler et al.~\cite{chandler2016analysis} identified correlations between Lagrangian-based interpolation error and divergence in the flow field.
%
Bujack et al.~\cite{bujack2015lagrangian} evaluated the use of parameter curves to fit interpolated pathline points to improve the aesthetic of trajectories calculated using Lagrangian data.
%
Hummel et al.~\cite{hummel2016error} provided theoretical error bounds for error propagation that can occur when calculating trajectories using Lagrangian representations. 
%
Finally, Jakob et al.~\cite{Jakob20} used DNNs to up-sample FTLE visualizations computed using reduced Lagrangian representations of 2D flow fields. 


\subsection{Time-Varying Vector Field Reduction}
%Within the vector field analysis and visualization community, Lagrangian methods have been increasingly used in the past decade.
%
%Lagrangian coherent structures (LCS) are a popular technique to visualize attracting and repelling surfaces and were introduced by Haller et al~\cite{haller2001distinguished, haller2000lagrangian, haller2000finding}.
%
%The interest in the technique led to multiple efforts that were aimed at accelerating the computation and visualization of LCS~\cite{garth2007efficient,garth2009visualization,sadlo2007efficient,sadlo2011time}.
%
%LCS have also been used for uncertain transient vector field visualization by Guo et al.~\cite{guo2016finite}.
%

Although a few studies have shown that Eulerian representations can be susceptible to temporal sparsity~\cite{costa2004lagrangian}\cite{Qin2014}\cite{agranovsky2014improved}\cite{sane2018revisiting}, temporal subsampling remains the widely used solution to limit data storage.
%
Our study contributes to this body of work by using temporal subsampling as a reference comparison.
%
Multiple works have proposed single time step vector field reduction strategies while maintaining an Eulerian representation.
%
%Lodha et al.~\cite{lodha2000topology} controlled the compression of similar vectors into single vectors representing larger area.
%
%Further, Lodha et al.~\cite{lodha2003topology} proposed a top-down topology preserving compression technique.
%
%Theisel et al.~\cite{theisel2003combining} computed critical points and viewed the task as a mesh reduction, and later provided a threshold to filter important features~\cite{theisel2003compression}.
%
%With the objective of highlighting temporal features of the vector field, Tong et al.~\cite{tong2012salient} compressed the total amount of data steps stored by identifying key time steps.
%
Although these techniques could be used to reduce and store data more frequently, they do not inherently address the challenge of increasing temporal sparsity.
%

In a recent large-scale tornadic supercell thunderstorm study~\cite{atmos10100578}, Leigh Orf modified the I/O code to use a hierarchical data format and lossy floating-point compression via ZFP~\cite{lindstrom2006fast}.
%
ZFP provides dynamic accuracy control by allowing the user to specify a maximum amount of deviation.
%
Orf stated that although ZFP is effective for scalar fields that do not require differentiation during post hoc analysis, to maintain accurate vector field reconstruction, only a very small value of deviation can be chosen for each component of velocity.
%
Thus, ZFP allowed a limited amount of compression to time-varying vector field data without introducing significant uncertainty to post hoc analysis. 
%
The technique provided an average reduction of 30\% of total uncompressed vector field data, with regions of high gradient resulting in less compression. 
%
%Overall, the scientist referred to the use of lossy compression as unfortunate but necessary.

%In this paper, using the same temporal sampling frequency as the Lagrangian representations, we measure the reconstruction accuracy achieved by temporal subsampling for reference.
%Although these techniques are valuable, they do not sufficiently address the challenge of increasing temporal sparsity.
%
%\fix{I think we need a better statement here --- could reduce to get higher temporal sparsity.  And yet don't want to compare with that.}
%For a baseline comparison in our empirical study, we store data in an Eulerian representation at full resolution and use temporal subsampling.
%
%This paper presents an empirical study of the in situ encumbrance and performance tradeoffs when executing \textit{in situ Lagrangian analysis} in a practical setting, i.e., in situ on a supercomputer.
